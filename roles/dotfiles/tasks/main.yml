---
- name: Create XDG config dir
  file: >
    path=~/.config
    state=directory

- name: Create fish config dir
  file: >
    path=~/.config/fish
    state=directory

- name: Create user bin dir
  file: >
    path=~/bin
    state=directory

- name: Symlink dotfiles
  file: >
    src={{ item.path }}
    dest={{ item.dest }}
    state=link
    force=yes
  with_items: '{{ dotfiles|default([]) }}'
  when: item.path is defined and item.dest is defined and item != ''

- shell: test -e ~/.config/fisherman; echo $?
  register: exist_fisherman

- name: Install fisherman
  command: curl -Lo ~/.config/fish/functions/fisher.fish --create-dirs https://git.io/fisher
  when: exist_fisherman.stdout == 1

- shell: test -e ~/.emacs.d; echo $?
  register: exist_emacsd

- name: Install spacemacs
  git: >
    repo='https://github.com/syl20bnr/spacemacs.git'
    dest='~/.emacs.d'
  when: exist_emacsd
